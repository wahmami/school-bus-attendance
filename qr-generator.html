<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>QR Code Generator</title>
</head>
<body>
  <h1>QR Code Generator</h1>
  <nav>
    <a href="index.html">Home</a> |
    <a href="qr-scanner.html">QR Code Scanner</a>
  </nav>
  <hr>
  <button id="loadBtn">Load Students & Generate QR</button>
  <div id="qrContainer" class="qr-container"></div>
  <style>
    .qr-container { display: flex; flex-wrap: wrap; gap: 2em; }
    .student-card { border: 1px solid #ccc; padding: 1em; text-align: center; width: 200px; }
    .student-name { font-weight: bold; margin-bottom: 0.5em; }
    button { margin-top: 0.5em; }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script>
    // Supabase credentials (replace with your actual values)
    const SUPABASE_URL = 'https://lwdgtnmasuxphgydxppb.supabase.co';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx3ZGd0bm1hc3V4cGhneWR4cHBiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkwMTMyMjEsImV4cCI6MjA3NDU4OTIyMX0.eolrB6h-YUhFAm2NCTprz84yi2Cve-9AfTGmHCrOJ4c';
    document.getElementById('loadBtn').onclick = async function() {
      const res = await fetch(`${SUPABASE_URL}/rest/v1/students`, {
        headers: {
          'apikey': SUPABASE_KEY,
          'Authorization': `Bearer ${SUPABASE_KEY}`,
          'Content-Type': 'application/json',
        }
      });
      const students = await res.json();
      renderQRCodes(students);
    };
    function renderQRCodes(students) {
  const container = document.getElementById('qrContainer');
  container.innerHTML = '';
  console.log('Rendering students:', students.map(s => `${s.id}: ${s.name}`));
  students.forEach((student, idx) => {
        const card = document.createElement('div');
        card.className = 'student-card';
        const name = document.createElement('div');
        name.className = 'student-name';
        name.textContent = student.name;
        card.appendChild(name);
        const qrDiv = document.createElement('div');
        qrDiv.id = `qr-${student.id}-${idx}`;
        card.appendChild(qrDiv);
        new QRCode(qrDiv, {
          text: String(student.id),
          width: 128,
          height: 128,
        });
        container.appendChild(card);
      });
    }
  </script>
</body>
</html>
